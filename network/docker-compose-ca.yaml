# docker-compose-ca.yaml
# Certificate Authority services for all organizations

networks:
  traffic:
    name: traffic-network
    driver: bridge

services:
  # Certificate Authority for OrdererOrg
  ca.orderer.example.com:
    image: hyperledger/fabric-ca:latest
    environment:
      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
      - FABRIC_CA_SERVER_CA_NAME=ca.orderer.example.com
      - FABRIC_CA_SERVER_TLS_ENABLED=true
      - FABRIC_CA_SERVER_PORT=7054
    ports:
      - "7054:7054"
    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
    volumes:
      - ./crypto-config/ordererOrganizations/example.com/ca/:/etc/hyperledger/fabric-ca-server
    container_name: ca.orderer.example.com
    networks:
      - traffic

  # Certificate Authority for TrafficOrg
  ca.traffic.example.com:
    image: hyperledger/fabric-ca:latest
    environment:
      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
      - FABRIC_CA_SERVER_CA_NAME=ca.traffic.example.com
      - FABRIC_CA_SERVER_TLS_ENABLED=true
      - FABRIC_CA_SERVER_PORT=7055
    ports:
      - "7055:7055"
    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
    volumes:
      - ./crypto-config/peerOrganizations/traffic.example.com/ca/:/etc/hyperledger/fabric-ca-server
    container_name: ca.traffic.example.com
    networks:
      - traffic

  # Certificate Authority for CityHallOrg
  ca.cityhall.example.com:
    image: hyperledger/fabric-ca:latest
    environment:
      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
      - FABRIC_CA_SERVER_CA_NAME=ca.cityhall.example.com
      - FABRIC_CA_SERVER_TLS_ENABLED=true
      - FABRIC_CA_SERVER_PORT=8055
    ports:
      - "8055:8055"
    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
    volumes:
      - ./crypto-config/peerOrganizations/cityhall.example.com/ca/:/etc/hyperledger/fabric-ca-server
    container_name: ca.cityhall.example.com
    networks:
      - traffic

  # Certificate Authority for PoliceOrg
  ca.police.example.com:
    image: hyperledger/fabric-ca:latest
    environment:
      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
      - FABRIC_CA_SERVER_CA_NAME=ca.police.example.com
      - FABRIC_CA_SERVER_TLS_ENABLED=true
      - FABRIC_CA_SERVER_PORT=9055
    ports:
      - "9055:9055"
    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
    volumes:
      - ./crypto-config/peerOrganizations/police.example.com/ca/:/etc/hyperledger/fabric-ca-server
    container_name: ca.police.example.com
    networks:
      - traffic

  # Certificate Authority for EmergencyOrg
  ca.emergency.example.com:
    image: hyperledger/fabric-ca:latest
    environment:
      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
      - FABRIC_CA_SERVER_CA_NAME=ca.emergency.example.com
      - FABRIC_CA_SERVER_TLS_ENABLED=true
      - FABRIC_CA_SERVER_PORT=10055
    ports:
      - "10055:10055"
    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
    volumes:
      - ./crypto-config/peerOrganizations/emergency.example.com/ca/:/etc/hyperledger/fabric-ca-server
    container_name: ca.emergency.example.com
    networks:
      - traffic
